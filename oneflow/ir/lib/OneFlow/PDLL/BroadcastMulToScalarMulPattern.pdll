#include "OneFlowPDLLUtils.pdll"

Pattern {
  let device_name: Attr;
  let device_tag: Attr;

  let broadcast_mul = op<oneflow.broadcast_mul>(x:Value, y:Value){device_name = device_name, device_tag = device_tag};
    
  rewrite broadcast_mul with{
    let scalar_mul = op<oneflow.scalar_mul_by_tensor>(x, y) {device_name = device_name, device_tag = device_tag};
    replace broadcast_mul with CopyUserOpAttrs(broadcast_mul, scalar_mul);
  };
}
