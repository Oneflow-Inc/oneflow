syntax = "proto2";
package oneflow;

import "oneflow/core/register/field_desc.proto";
import "oneflow/core/common/shape.proto";

message FieldHeaderDesc {
  // shape: [body.shape.dim(0)]
  optional FieldDescProto data_id = 1;

  // shape: [body.shape.dim(0)]
  optional FieldDescProto col_num = 2;

  // shape: [body.shape.dim(0)]
  optional FieldDescProto instance_available_elem_cnt = 3;

  // shape: [instance_extra_shape.shape.dim(0)]
  optional FieldDescProto available_instance_num = 4;
}

message BlobHeaderDescProto {
  required int32 max_col_num = 1;
  required int32 blob_mem_id = 2;
  oneof header_type {
    FieldDescProto opaque_header = 3;
    FieldHeaderDesc field_header = 4;
  }
}

message BlobDescProto {
  required BlobHeaderDescProto header = 1;
  required FieldDescProto body = 2;
  // the element count of instance_extra_shape.shape equals body.shape.dim(0)
  optional ShapeProto instance_extra_shape = 3;
}
